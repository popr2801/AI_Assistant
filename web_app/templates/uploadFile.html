{% load static %}
<!DOCTYPE html>
<html>
    <head>
        <title>AI Assistant</title>
        <script src="https://unpkg.com/htmx.org@1.9.2"></script>
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
        <style>
            body{
                display: flex;
                align-items: center;
                justify-content: center;
                text-align: center;
                font-family: "Poppins";
                background: #2e2e6b;
                background: linear-gradient(90deg,rgba(46, 46, 107, 1) 0%, rgba(48, 22, 97, 1) 20%, rgba(10, 0, 20, 1) 100%);
            }
            #main > h1{
                text-align: center;
                color:white;
                font-weight:500;
                font-size:50px;
            }
            #response{
                flex-grow: 1;           
                overflow-y: auto;  
                word-break: break-word;
                white-space: normal;
                margin-bottom: 60px; 
            }
            #messages{
                position: relative;
                width:400px;
                height:500px;
                background-color: white;
                word-break: break-word;
                white-space: normal;
                padding:10px;
                font-family:'Poppins';
                border-radius: 10px;
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
            }
            #id_file{
                width: 180px;
            }
            #message-bar{
                margin-top:5px;
                width:426px;
                display: flex;
                justify-content: center;
                
            }
            #id_question{
                bottom: 10px;
                left:30px;
                outline: none;
                height: 35px;
                border:1px;
                border-radius: 10px;
                font-size:large;
                caret-color:black;
                width:300px;
                vertical-align: middle;
                padding:5px;
                margin-right: 10px;
                box-shadow: 0 10px 20px rgba(0, 0, 0, 0.4);
            }
            #submit-button{
                height:45px;
                border:none;
                border-radius:10px;
                font-weight: 600;
                background-color: white;
                vertical-align: middle;
                width: 60px;
                transition: background-color 0.3s ease-in-out;
                box-shadow: 0 10px 20px rgba(0, 0, 0, 0.4);
                display: flex;
                align-items: center;
                justify-content: center;
                margin:0;
            }
            #send-logo{
                position:relative;
                top:2px;
                right:1px;
                width:25px;
                height:25px;
            }
            #submit-button:hover{
                cursor:pointer;
                background-color: whitesmoke;
            }
            .star {
                position: absolute;
                background: white;
                border-radius: 50%;
                opacity: 0.8;
                box-shadow: 0 0 5px 1px white;
                pointer-events: none;
                animation: twinkle 3s infinite alternate;
            }
            @keyframes twinkle {
                0%   { opacity: 0.8; }
                100% { opacity: 0.2; }
            }
        </style>
        <script defer>
            function clearInput(id) {
                const input = document.getElementById(id);
                if (input) input.value = '';
            }
            function createStars(numStars) {
                const body = document.body;
                const width = window.innerWidth;
                const height = window.innerHeight;

                for(let i = 0; i < numStars; i++) {
                    const star = document.createElement('div');
                    star.classList.add('star');

                    const size = Math.random() * 2 + 1;
                    star.style.width = `${size}px`;
                    star.style.height = `${size}px`;

                    star.style.left = Math.random() * width + 'px';
                    star.style.top = Math.random() * height + 'px';

                    star.style.animationDelay = `${Math.random() * 3}s`;

                    body.appendChild(star);
                }
            }
            window.onload = function() {
                createStars(100);
            };
        </script>
    </head>
    <body>
        <div id="main">
            <h1>AI Assistant</h1>
            <div id="messages">
                <div id="response"></div>
                <form  hx-post="{% url 'uploadFile' %}" hx-on="htmx:beforeRequest: clearInput('id_question')" hx-target="#response" hx-swap="innerHTML" method="post" enctype="multipart/form-data">
                    {% csrf_token %}
                    <div id="message-bar">{{ form.question }}<button id="submit-button" type="submit"><img src="{% static 'send.png' %}" id="send-logo"></button></div>
                    {{ form.file }}
                </form>
            </div>
        </div>
    </body>
</html>