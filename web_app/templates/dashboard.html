{% load filename_filters %}
<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Dashboard</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
        <script src="https://unpkg.com/htmx.org@1.9.2"></script>
        <style>
            html,body{
                height:100%;
            }
            body{
                display: flex;
                justify-content: center;
                align-items: center;
                background: #2e2e6b;
                background: linear-gradient(90deg,rgba(46, 46, 107, 1) 0%, rgba(48, 22, 97, 1) 20%, rgba(10, 0, 20, 1) 100%);
                font-family:"Poppins";
            }
            #main > h1 {
                position: absolute;
                top:-1vw;
                left:30px;
                color:white;
                font-weight: 500;
                font-size: 4vw;
            }
            #main{
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
                height:100%;
            }
            .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            opacity: 0.8;
            box-shadow: 0 0 5px 1px white;
            pointer-events: none;
            animation: twinkle 3s infinite alternate;
            }
            #button-div{
                position:relative;
                top:150px;
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
                margin-top:150px;
                flex-wrap: wrap;
            }
            #button-div > button{
                max-width: 90vw;
                width:30vw;
                height:10vh;
                font-size:3vh;
                font-family:"Poppins";
                border:none;
                border-radius:35px;
                margin:8px;
                color:white;
            }
            #add-files-button{
                display: inline-block;
                background-color: white;
                color: black;
                text-align: center;
                line-height: 10vh;
                width: 30vw;
                height: 10vh;
                font-size: 3vh;
                font-family: "Poppins";
                border: none;
                border-radius: 35px;
                margin: 8px;
                transition: transform 0.3s ease-in-out, color 1s ease-in-out;
                cursor: pointer;
            }
            #add-files-button:hover{
                transform: scale(1.05);
                cursor: pointer;
            }
            #assistant-button{
                display: inline-block;
                background-color: #ffbe0b;
                transition: transform 0.3s ease-in-out, color 1s ease-in-out;
            }
            #button-div > button:hover{
                transform: scale(1.05);
                cursor: pointer;
            }
            #customize-assistant{
                display: inline-block;
                background-color: #5e2bab;
                transition: transform 0.3s ease-in-out, color 1s ease-in-out;
            }
            @keyframes twinkle {
            0%   { opacity: 0.8; }
            100% { opacity: 0.2; }
            }
            #my-files{
                width:26vw;
                height:75vh;
                background-color:white;
                position: absolute;
                left:30px;
                text-align: center;
                font-size: 30px;
                border-radius: 15px;
                margin-top:60px;
                font-weight:600;    
                color:#5e2bab;
                padding-top: 10px;
                word-break: break-word;
                white-space: normal;
            }
            #my-files > p{
                font-size:20px;
                margin-left:15px;
                margin-right:15px;
                margin-bottom:0px;
                margin-top:0px;
            }
            #delete-button{
                width:7vw;
                height:5vh;
                border-radius:10px;
                border:none;
                color:white;
                font-size:1.3vw;
                text-align: center;
                background-color: red;
                transition: background-color 0.5s ease-in-out;
                margin-bottom:15px;
            }
            #delete-button:hover{
                background-color:rgb(183, 12, 12);
                cursor: pointer;
            }
        </style>
    </head>
    <body>
        <div id="main">
            <h1>Hello, {{ user.first_name }}!</h1>
            <div id="my-files">
                My Files
                
                    {% for file in files %}
                        <p>{{ file.uploaded_file|filename }}</p>
                        <form method="post" action="{% url 'delete_file' file.id %}">
                            {% csrf_token %}
                            <button type="submit" id="delete-button">Delete</button>
                        </form>
                    {% empty %}
                        <p>No files yet.</p>
                    {% endfor %}
                
            </div>
            <div id="button-div">
                <form method="post" hx-post="{% url 'dashboard' %}" enctype="multipart/form-data">
                    {% csrf_token %}
                    <label id="add-files-button" for="file-input" hx-trigger="click">Add Files</label>
                    <input id="file-input" type="file" name="uploaded_file" style="display: none;" onchange="this.form.submit()">
                </form>
                <button id="assistant-button" onclick="window.location.href='/assistant/'">AI Assistant</button>
                <button id="customize-assistant">Customize Assistant</button>
            </div>
        </div>
        <script>
            function createStars(numStars) {
            const body = document.body;
            const width = window.innerWidth;
            const height = window.innerHeight;
    
            for(let i = 0; i < numStars; i++) {
                const star = document.createElement('div');
                star.classList.add('star');
                const size = Math.random() * 2 + 1;
                star.style.width = `${size}px`;
                star.style.height = `${size}px`;
                star.style.left = Math.random() * width + 'px';
                star.style.top = Math.random() * height + 'px';
                star.style.animationDelay = `${Math.random() * 3}s`;
                body.appendChild(star);
            }
            }
        </script>
    </body>
</html>